name: D√©ploiement du Site Web

on:
  push:
    branches:
      - main  # D√©clenche le workflow lors d'un push sur la branche 'main'

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: R√©cup√©rer le code source
        uses: actions/checkout@v3

      - name: Debug Secrets
        run: |
          echo "üîç V√©rification des secrets GitHub..."
          if [ -z "${{ secrets.YOUR_API_KEY }}" ]; then
            echo "‚ùå ERREUR : Le secret YOUR_API_KEY n'est pas accessible !"
            exit 1
          else
            echo "‚úÖ SUCC√àS : Le secret YOUR_API_KEY est accessible !"
          fi

      - name: Remplacer la cl√© API dans google-maps-loader.js
        run: |
          set -e  # Arr√™te l'ex√©cution en cas d'erreur
          API_KEY=$(echo "${{ secrets.YOUR_API_KEY }}" | sed 's/[\/&]/\\&/g')
          sed -i "s/YOUR_API_KEY/${API_KEY}/g" google-maps-loader.js

      - name: D√©ployer le site web
        uses: actions/deploy-pages@v2
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
